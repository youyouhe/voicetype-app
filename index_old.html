<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="/src/styles.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Voice Assistant - Tauri</title>
    <script type="module" src="/src/main.ts" defer></script>
  </head>

  <body>
    <div class="app-container">
      <header class="app-header">
        <h1>🎤 Voice Assistant</h1>
        <p class="subtitle">Powered by Rust + Tauri</p>
      </header>

      <main class="container">
        <!-- Voice Assistant Control Panel -->
        <section class="control-panel">
          <h2>语音助手控制</h2>

          <div class="status-section">
            <div class="status-indicator">
              <span id="status-light" class="status-dot idle"></span>
              <span id="status-text">待机中</span>
            </div>
            <div class="status-details" id="status-details">
              <span>状态: 就绪</span>
            </div>
          </div>

          <div class="control-buttons">
            <button id="start-assistant" class="btn btn-primary">
              ▶️ 启动语音助手
            </button>
            <button id="stop-assistant" class="btn btn-secondary" disabled>
              ⏹️ 停止语音助手
            </button>
          </div>

          <div class="hotkey-info">
            <h3>快捷键说明</h3>
            <div class="hotkey-grid">
              <div class="hotkey-item">
                <kbd>Alt</kbd> <span>长时间按住</span>
                <p>开始语音转录</p>
              </div>
              <div class="hotkey-item">
                <kbd>Alt</kbd> + <kbd>Shift</kbd> <span>长时间按住</span>
                <p>开始语音翻译</p>
              </div>
            </div>
          </div>
        </section>

        <!-- Processor Configuration -->
        <section class="config-panel">
          <h2>处理器配置</h2>

          <div class="config-tabs">
            <button class="tab-button active" data-tab="asr">ASR设置</button>
            <button class="tab-button" data-tab="translate">翻译设置</button>
            <button class="tab-button" data-tab="api">API配置</button>
            <button class="tab-button" data-tab="system">系统信息</button>
          </div>

          <!-- ASR Settings Tab -->
          <div class="tab-content active" id="asr-tab">
            <div class="config-group">
              <label for="asr-processor">ASR处理器:</label>
              <select id="asr-processor">
                <option value="whisper">Whisper (Groq)</option>
                <option value="sensevoice">SenseVoice (SiliconFlow)</option>
                <option value="local">本地ASR</option>
              </select>
            </div>

            <div class="config-group">
              <label for="convert-simplified">
                <input type="checkbox" id="convert-simplified" checked>
                转换繁体中文为简体
              </label>
            </div>

            <div class="config-group">
              <label for="add-symbol">
                <input type="checkbox" id="add-symbol" checked>
                添加标点符号
              </label>
            </div>

            <button id="test-asr" class="btn btn-test">🧪 测试ASR</button>
          </div>

          <!-- Translation Settings Tab -->
          <div class="tab-content" id="translate-tab">
            <div class="config-group">
              <label for="translate-processor">翻译处理器:</label>
              <select id="translate-processor">
                <option value="siliconflow">SiliconFlow</option>
                <option value="ollama">Ollama (本地)</option>
              </select>
            </div>

            <button id="test-translation" class="btn btn-test">🧪 测试翻译</button>
          </div>

          <!-- API Configuration Tab -->
          <div class="tab-content" id="api-tab">
            <div class="config-group">
              <label for="groq-api-key">Groq API Key:</label>
              <input type="password" id="groq-api-key" placeholder="输入Groq API密钥">
            </div>

            <div class="config-group">
              <label for="siliconflow-api-key">SiliconFlow API Key:</label>
              <input type="password" id="siliconflow-api-key" placeholder="输入SiliconFlow API密钥">
            </div>

            <div class="config-group">
              <label for="local-asr-url">本地ASR地址:</label>
              <input type="url" id="local-asr-url" placeholder="http://192.168.8.107:5001/inference">
            </div>

            <div class="config-group">
              <label for="ollama-url">Ollama地址:</label>
              <input type="url" id="ollama-url" placeholder="http://192.168.8.107:11434/api/chat">
            </div>

            <button id="save-config" class="btn btn-primary">💾 保存配置</button>
          </div>

          <!-- System Info Tab -->
          <div class="tab-content" id="system-tab">
            <div id="system-info" class="system-info">
              <p>正在加载系统信息...</p>
            </div>
            <button id="refresh-system-info" class="btn btn-secondary">🔄 刷新</button>
          </div>
        </section>

        <!-- Test Results -->
        <section class="results-panel">
          <h2>测试结果</h2>
          <div id="test-results" class="results-container">
            <p class="placeholder">测试结果将显示在这里</p>
          </div>
        </section>

        <!-- Legacy Test Section (hidden by default) -->
        <section class="legacy-test" style="display: none;">
          <h2>Legacy Tests</h2>
          <form class="row" id="greet-form">
            <input id="greet-input" placeholder="Enter a name..." />
            <button type="submit">Greet</button>
            <input id="num1" type="number">
            <input id="num2" type="number">
          </form>
          <p id="greet-msg"></p>
        </section>
      </main>
    </div>
  </body>
</html>
